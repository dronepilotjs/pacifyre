<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Walraven Pacifyre¬Æ Sealant Consumption Calculator | Walraven</title>
  <style>
    :root {
      --wr-green: #006c4f;
      --wr-bg: #f5f5f5;
      --wr-text: #333;
      --wr-muted: #666;
      --wr-border: #e0e0e0;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      background: var(--wr-bg);
      min-height: 100vh;
      color: var(--wr-text);
    }

    .top-bar {
      background: var(--wr-green);
      color: #fff;
      padding: 8px 20px;
      font-size: 13px;
      text-align: right;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: #fff;
    }

    .header {
      background: var(--wr-green);
      padding: 18px 28px;
      border-bottom: 3px solid var(--wr-green);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      color: #fff;
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 16px;
      min-width: 0;
    }

    .logo { display: flex; align-items: center; }

    .walraven-logo {
      height: 32px;
      width: auto;
      display: block;
    }

    .divider {
      width: 2px;
      height: 36px;
      background: rgba(255, 255, 255, 0.35);
      flex: 0 0 auto;
    }

    .app-title {
      color: #fff;
      font-size: 16px;
      font-weight: 700;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .language-selector {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255, 255, 255, 0.12);
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.18);
    }

    .language-selector label {
      font-size: 12px;
      opacity: 0.9;
      white-space: nowrap;
    }

    .select-wrap {
      position: relative;
      display: inline-flex;
      align-items: center;
    }

    .select-wrap::after {
      content: '‚ñæ';
      position: absolute;
      right: 12px;
      pointer-events: none;
      color: var(--wr-green);
      font-size: 12px;
    }

    select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background: rgba(255, 255, 255, 0.95);
      color: var(--wr-green);
      border: 1px solid rgba(255, 255, 255, 0.5);
      padding: 8px 34px 8px 12px;
      border-radius: 6px;
      font-weight: 800;
      font-size: 13px;
      cursor: pointer;
    }

    .hero {
      background: linear-gradient(135deg, var(--wr-green) 0%, #028c66 100%);
      color: #fff;
      padding: 40px 28px;
      text-align: center;
    }

    .hero h1 {
      font-size: 2.1em;
      margin-bottom: 10px;
      font-weight: 800;
    }

    .hero p {
      font-size: 1.1em;
      opacity: 0.95;
    }

    .content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
    }

    .section { padding: 36px 28px; }

    .section.inputs {
      background: #f9f9f9;
      border-right: 1px solid var(--wr-border);
    }

    .section.results { background: #fff; }

    .section h2 {
      color: var(--wr-green);
      margin-bottom: 22px;
      font-size: 1.45em;
      font-weight: 800;
      padding-bottom: 12px;
      border-bottom: 2px solid var(--wr-green);
    }

    .form-group { margin-bottom: 18px; }

    .form-group label {
      display: block;
      font-weight: 800;
      color: var(--wr-text);
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-group input[type='number'],
    .form-group input[type='text'] {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #d0d0d0;
      border-radius: 6px;
      font-size: 14px;
      transition: all 0.2s;
      font-family: Arial, Helvetica, sans-serif;
    }

    .form-group input[type='number']:focus {
      outline: none;
      border-color: var(--wr-green);
      box-shadow: 0 0 0 2px rgba(0, 108, 79, 0.12);
    }

    .radio-group {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .radio-option input[type='radio'] {
      width: 16px;
      height: 16px;
      cursor: pointer;
      accent-color: var(--wr-green);
    }

    .radio-option label {
      cursor: pointer;
      margin: 0;
      font-weight: 600;
      font-size: 14px;
      color: var(--wr-text);
    }

    .subsection {
      background: #fff;
      padding: 18px;
      border-radius: 10px;
      margin-bottom: 12px;
      border: 1px solid var(--wr-border);
      border-left: 4px solid #d0d0d0;
    }

    .subsection.active {
      border-left-color: var(--wr-green);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .subsection h3 {
      color: var(--wr-muted);
      font-size: 15px;
      margin-bottom: 14px;
      font-weight: 800;
    }

    .subsection.active h3 { color: var(--wr-green); }

    .result-item {
      background: #f9f9f9;
      padding: 16px;
      border-radius: 10px;
      margin-bottom: 12px;
      border-left: 4px solid var(--wr-border);
    }

    .result-item.highlight {
      background: #f2fbf7;
      border-left-color: var(--wr-green);
    }

    .result-item.primary {
      background: #f0fff9;
      border-left-color: var(--wr-green);
    }

    .result-label {
      font-size: 13px;
      color: var(--wr-muted);
      margin-bottom: 6px;
      font-weight: 700;
    }

    .result-value {
      font-size: 2em;
      font-weight: 900;
      color: var(--wr-green);
    }

    .result-unit {
      font-size: 0.6em;
      color: var(--wr-muted);
      margin-left: 6px;
      font-weight: 700;
    }

    .info-box {
      background: #fffbf0;
      border: 1px solid #ffd966;
      border-left: 4px solid #ffa500;
      border-radius: 10px;
      padding: 14px;
      margin-top: 18px;
      font-size: 13px;
      line-height: 1.5;
    }

    .info-box strong { color: #cc8800; }

    .toggle-btn {
      width: 100%;
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(0, 108, 79, 0.35);
      background: rgba(0, 108, 79, 0.08);
      color: var(--wr-green);
      font-weight: 900;
      cursor: pointer;
      transition: transform 0.05s ease, background 0.2s ease;
    }

    .toggle-btn:hover { background: rgba(0, 108, 79, 0.12); }
    .toggle-btn:active { transform: translateY(1px); }

    .details-panel {
      margin-top: 14px;
      padding-top: 10px;
      border-top: 1px solid var(--wr-border);
    }

    .details-title {
      font-weight: 900;
      color: var(--wr-green);
      margin-bottom: 10px;
      font-size: 14px;
      opacity: 0.95;
    }

    .hidden { display: none; }

    .lock-icon {
      display: inline-flex;
      vertical-align: middle;
      margin-right: 8px;
      color: var(--wr-green);
    }

    .lock-icon svg { display: block; }

    .warn-box {
      background: #fff5f0;
      border: 1px solid #ffb199;
      border-left: 4px solid #ff6b3d;
      border-radius: 10px;
      padding: 12px 14px;
      margin-top: 12px;
      font-size: 13px;
      line-height: 1.45;
      color: #7a2a14;
    }

    .warn-box strong { color: #c23a1a; }

    .footer {
      background: var(--wr-green);
      color: #fff;
      padding: 26px 28px;
    }

    .footer-content {
      max-width: 900px;
      margin: 0 auto;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      align-items: start;
    }

    .footer-left { text-align: left; }
    .footer-right { text-align: right; }

    .footer-left p {
      margin: 6px 0;
      opacity: 0.92;
      font-size: 14px;
    }

    .footer-links a {
      color: #fff;
      text-decoration: none;
      margin: 0 14px;
      font-size: 13px;
      opacity: 0.86;
      transition: opacity 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .footer-links a:hover {
      opacity: 1;
      text-decoration: underline;
    }

    .instagram-icon {
      width: 18px;
      height: 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: #005a42;
      border: 1px solid rgba(255, 255, 255, 0.28);
      border-radius: 4px;
    }

    .instagram-icon svg {
      width: 12px;
      height: 12px;
      stroke: #fff;
      fill: none;
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    @media (max-width: 768px) {
      .content { grid-template-columns: 1fr; }

      .section.inputs {
        border-right: none;
        border-bottom: 1px solid var(--wr-border);
      }

      .header {
        flex-direction: column;
        align-items: flex-start;
      }

      .logo-area { width: 100%; }
      .divider { display: none; }

      .language-selector {
        width: 100%;
        justify-content: space-between;
      }

      .select-wrap, select { width: 100%; }

      .footer-grid { grid-template-columns: 1fr; }
      .footer-right { text-align: left; }
      .footer-links { margin-top: 12px; }
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <span id="topBarText">Multinational with a heart | Since 1942</span>
  </div>

  <div class="container">
    <div class="header">
      <div class="logo-area">
        <div class="logo">
          <img
            src="https://www.walraven.com/de/wp-content/themes/walraven/assets/images/logo.svg"
            alt="Walraven"
            class="walraven-logo"
          />
        </div>
        <div class="divider"></div>
        <div class="app-title" id="appTitle">Walraven Pacifyre¬Æ Calculator</div>
      </div>

      <div class="language-selector">
        <label for="langSelect" id="langLabel">Language</label>
        <div class="select-wrap">
          <select id="langSelect" aria-label="Language selector">
            <option value="en">üá¨üáß English</option>
            <option value="cs">üá®üáø ƒåe≈°tina</option>
            <option value="sk">üá∏üá∞ Slovenƒçina</option>
            <option value="pl">üáµüá± Polski</option>
            <option value="nl">üá≥üá± Nederlands</option>
          </select>
        </div>
      </div>
    </div>

    <div class="hero">
      <h1 id="heroTitle">üî• Walraven Pacifyre¬Æ Sealant Calculator</h1>
      <p id="heroSubtitle">Fire sealant consumption calculation for wall and floor penetrations</p>
    </div>

    <div class="content">
      <!-- Left column - inputs -->
      <div class="section inputs">
        <h2 id="inputsTitle">Input Parameters</h2>

        <div class="form-group">
          <label id="labelSealantType">Sealant Type</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="sealantType" value="A" id="sealantA" checked />
              <label for="sealantA" id="sealantALabel">Walraven Pacifyre¬Æ A (10 mm)</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="sealantType" value="G" id="sealantG" />
              <label for="sealantG" id="sealantGLabel">Walraven Pacifyre¬Æ G (25 mm)</label>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>
            <span class="lock-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="16" height="16" focusable="false" xmlns="http://www.w3.org/2000/svg">
                <path
                  fill="currentColor"
                  d="M17 8h-1V6a4 4 0 10-8 0v2H7a2 2 0 00-2 2v9a2 2 0 002 2h10a2 2 0 002-2v-9a2 2 0 00-2-2zm-7-2a2 2 0 114 0v2h-4V6zm7 13H7v-9h10v9z"
                />
              </svg>
            </span>
            <span id="labelDepthText">Fill Depth (fixed: A = 10 mm, G = 25 mm)</span>
          </label>
          <input
            type="text"
            id="depth"
            readonly
            disabled
            style="background: #e9ecef; font-weight: 800; color: var(--wr-green);"
          />
        </div>

        <div class="form-group">
          <label id="labelOpeningType">Opening Type</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="openingType" value="circular" id="openingCircular" checked />
              <label for="openingCircular" id="labelCircular">Circular</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="openingType" value="rectangular" id="openingRectangular" />
              <label for="openingRectangular" id="labelRectangular">Rectangular</label>
            </div>
          </div>
        </div>

        <!-- Circular opening -->
        <div class="subsection active" id="circularSection">
          <h3 id="titleCircular">‚≠ï Circular Opening Parameters</h3>
          <div class="form-group">
            <label id="labelPipeDiameter">Pipe Diameter (mm)</label>
            <input type="number" id="pipeDiameter" value="100" min="0" />
            <div class="warn-box hidden" id="pipeLimitInfo" role="note" aria-live="polite" style="margin-top:8px;">
              <strong id="pipeLimitInfoTitle">‚ÑπÔ∏è Note:</strong>
              <span id="pipeLimitInfoText">For Walraven Pacifyre¬Æ G, maximum pipe diameter is 50 mm.</span>
            </div>
          </div>
          <div class="form-group">
            <label id="labelInsulation">Insulation Thickness (mm)</label>
            <input type="number" id="insulationThickness" value="30" min="0" />
          </div>
          <div class="form-group">
            <label id="labelAnnularGap">Annular Gap Width (mm)</label>
            <input type="number" id="annularGap" value="20" min="0" />
            <div class="warn-box hidden" id="circularOpeningLimitInfo" role="note" aria-live="polite" style="margin-top:8px;">
              <strong id="circularOpeningLimitTitle">‚ÑπÔ∏è Note:</strong>
              <span id="circularOpeningLimitText">For Walraven Pacifyre¬Æ A/G, maximum opening diameter (pipe + insulation + 2√ó gap) is 300 mm / 250 mm.</span>
            </div>
          </div>
        </div>

        <!-- Rectangular opening -->
        <div class="subsection" id="rectangularSection" style="display: none">
          <h3 id="titleRectangular">‚ñ≠ Rectangular Opening Parameters</h3>

          <div class="form-group">
            <label id="labelOpeningWidth">Opening Width (mm)</label>
            <input type="number" id="openingWidth" value="200" min="0" />
            <div class="warn-box hidden" id="rectWidthLimitInfo" role="note" aria-live="polite" style="margin-top:8px;">
              <strong id="rectWidthLimitTitle">‚ÑπÔ∏è Note:</strong>
              <span id="rectWidthLimitText">For Walraven Pacifyre¬Æ G, maximum opening width is 250 mm.</span>
            </div>
          </div>

          <div class="form-group">
            <label id="labelOpeningHeight">Opening Height (mm)</label>
            <input type="number" id="openingHeight" value="150" min="0" />
            <div class="warn-box hidden" id="rectHeightLimitInfo" role="note" aria-live="polite" style="margin-top:8px;">
              <strong id="rectHeightLimitTitle">‚ÑπÔ∏è Note:</strong>
              <span id="rectHeightLimitText">For Walraven Pacifyre¬Æ G, maximum opening height is 250 mm.</span>
            </div>
          </div>

          <div class="form-group">
            <label id="labelPipeDiameterRect">Pipe Diameter (mm)</label>
            <input type="number" id="pipeDiameterRect" value="100" min="0" />
            <div class="warn-box hidden" id="pipeLimitInfoRect" role="note" aria-live="polite" style="margin-top:8px;">
              <strong id="pipeLimitInfoTitleRect">‚ÑπÔ∏è Note:</strong>
              <span id="pipeLimitInfoTextRect">For Walraven Pacifyre¬Æ G, maximum pipe diameter is 50 mm.</span>
            </div>
          </div>

          <div class="form-group">
            <label id="labelInsulationRect">Insulation Thickness (mm)</label>
            <input type="number" id="insulationThicknessRect" value="30" min="0" />
          </div>
        </div>

        <div class="form-group">
          <label id="labelSealType">Seal Type</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" name="sealType" value="double" id="sealDouble" checked />
              <label for="sealDouble" id="labelDouble">Double-sided</label>
            </div>
            <div class="radio-option">
              <input type="radio" name="sealType" value="single" id="sealSingle" />
              <label for="sealSingle" id="labelSingle">Single-sided</label>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label id="labelCount">Number of Penetrations</label>
          <input type="number" id="penetrationCount" value="5" min="1" />
        </div>
      </div>

      <!-- Right column - results -->
      <div class="section results">
        <h2 id="resultsTitle">Calculation Results</h2>

        <div class="result-item highlight" style="margin-top: 6px;">
          <div class="result-label" id="labelCartridges">üì¶ Number of Cartridges (300 ml)</div>
          <div class="result-value" id="cartridges">0<span class="result-unit">pcs</span></div>
        </div>

        <button type="button" class="toggle-btn" id="toggleDetails" aria-expanded="false">
          <span id="toggleDetailsText">Show calculation steps</span>
        </button>

        <div id="detailsPanel" class="details-panel hidden" aria-hidden="true">
          <div class="details-title" id="detailsTitle">Calculation steps</div>

          <div id="calcCircular">
            <h3 style="color: var(--wr-green); margin-bottom: 12px; font-size: 16px" id="calcTitleCircular">
              Intermediate Calculations (circular)
            </h3>
            <div class="result-item">
              <div class="result-label" id="labelD2">Outer Diameter with Insulation (d2)</div>
              <div class="result-value" id="d2">0<span class="result-unit">mm</span></div>
            </div>
            <div class="result-item">
              <div class="result-label" id="labelD3">Outer Diameter with Fill (d3)</div>
              <div class="result-value" id="d3">0<span class="result-unit">mm</span></div>
            </div>
            <div class="result-item">
              <div class="result-label" id="labelAnnularArea">Annular Area</div>
              <div class="result-value" id="annularArea">0<span class="result-unit">mm¬≤</span></div>
            </div>
          </div>

          <div id="calcRectangular" style="display: none">
            <h3 style="color: var(--wr-green); margin-bottom: 12px; font-size: 16px" id="calcTitleRectangular">
              Intermediate Calculations (rectangular)
            </h3>
            <div class="result-item">
              <div class="result-label" id="labelOpeningVolume">Opening volume (W√óH√ódepth)</div>
              <div class="result-value" id="openingVolume">0<span class="result-unit">ml</span></div>
            </div>
            <div class="result-item">
              <div class="result-label" id="labelOccupiedVolume">Pipe + insulation volume</div>
              <div class="result-value" id="occupiedVolume">0<span class="result-unit">ml</span></div>
            </div>

            <div class="warn-box hidden" id="rectWarning" role="alert" aria-live="polite">
              <strong id="rectWarningTitle">‚ö†Ô∏è Warning:</strong>
              <span id="rectWarningText">
                Pipe + insulation does not fit into the opening (occupied volume exceeds opening volume). Sealant volume is set to 0.
              </span>
            </div>
          </div>

          <div class="result-item primary">
            <div class="result-label" id="labelVolumeOne">Volume per Penetration</div>
            <div class="result-value" id="volumeOne">0<span class="result-unit">ml</span></div>
          </div>

          <div class="result-item highlight">
            <div class="result-label" id="labelTotalConsumption">‚úÖ Total Sealant Consumption</div>
            <div class="result-value" id="totalConsumption">0<span class="result-unit">ml</span></div>
          </div>

          <div class="info-box">
            <strong id="infoNote">‚ÑπÔ∏è Note:</strong>
            <span id="infoText">Number of cartridges is rounded up.</span>
            <span id="calcDetail"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="footer-content">
        <div class="footer-grid">
          <div class="footer-left">
            <p><strong>WALRAVEN</strong> | Multinational with a heart</p>
            <p id="footerText">Fire protection solutions for buildings</p>
          </div>
          <div class="footer-right">
            <div class="footer-links">
              <a href="https://www.walraven.com" target="_blank" rel="noreferrer">walraven.com</a>
              <a href="https://www.instagram.com/dronepilotjs/" target="_blank" rel="noopener noreferrer" id="footerContact">
                <span class="instagram-icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="5" ry="5"></rect>
                    <circle cx="12" cy="12" r="4"></circle>
                    <circle cx="17" cy="7" r="1.2"></circle>
                  </svg>
                </span>
                <span>Contact</span>
              </a>
              <a href="#" id="footerSupport">Technical Support</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // TRANSLATIONS  (FIX #1: all language objects now contain every
    //                required key; FIX #3: duplicate keys removed)
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const translations = {

      en: {
        langLabel: 'Language',
        topBarText: 'Multinational with a heart | Since 1942',
        appTitle: 'Walraven Pacifyre¬Æ Calculator',
        heroTitle: 'üî• Walraven Pacifyre¬Æ Sealant Calculator',
        heroSubtitle: 'Fire sealant consumption calculation for wall and floor penetrations',

        inputsTitle: 'Input Parameters',
        resultsTitle: 'Calculation Results',

        labelSealantType: 'Sealant Type',
        sealantALabel: 'Walraven Pacifyre¬Æ A (10 mm)',
        sealantGLabel: 'Walraven Pacifyre¬Æ G (25 mm)',
        labelDepth: 'Fill Depth (fixed: A = 10 mm, G = 25 mm)',

        labelOpeningType: 'Opening Type',
        labelCircular: 'Circular',
        labelRectangular: 'Rectangular',

        titleCircular: '‚≠ï Circular Opening Parameters',
        labelPipeDiameter: 'Pipe Diameter (mm)',
        labelInsulation: 'Insulation Thickness (mm)',
        labelAnnularGap: 'Annular Gap Width (mm)',

        // FIX #3: only one definition per key
        pipeLimitInfoTitle: '‚ÑπÔ∏è Note:',
        pipeLimitInfoText: 'For Walraven Pacifyre¬Æ G, maximum pipe diameter is 50 mm.',

        circularOpeningLimitTitle: '‚ÑπÔ∏è Note:',
        circularOpeningLimitText: (maxMm) => `For Walraven Pacifyre¬Æ, maximum opening diameter (pipe + insulation + 2√ó gap) is ${maxMm} mm.`,

        rectWidthLimitTitle: '‚ÑπÔ∏è Note:',
        rectWidthLimitText: 'For Walraven Pacifyre¬Æ G, maximum opening width is 250 mm.',
        rectHeightLimitTitle: '‚ÑπÔ∏è Note:',
        rectHeightLimitText: 'For Walraven Pacifyre¬Æ G, maximum opening height is 250 mm.',

        titleRectangular: '‚ñ≠ Rectangular Opening Parameters',
        labelOpeningWidth: 'Opening Width (mm)',
        labelOpeningHeight: 'Opening Height (mm)',
        labelPipeDiameterRect: 'Pipe Diameter (mm)',
        labelInsulationRect: 'Insulation Thickness (mm)',

        labelSealType: 'Seal Type',
        labelSingle: 'Single-sided',
        labelDouble: 'Double-sided',

        labelCount: 'Number of Penetrations',

        calcTitleCircular: 'Intermediate Calculations (circular)',
        labelD2: 'Outer Diameter with Insulation (d2)',
        labelD3: 'Outer Diameter with Fill (d3)',
        labelAnnularArea: 'Annular Area',

        calcTitleRectangular: 'Intermediate Calculations (rectangular)',
        labelOpeningVolume: 'Opening volume (W√óH√ódepth)',
        labelOccupiedVolume: 'Pipe + insulation volume',

        rectWarningTitle: '‚ö†Ô∏è Warning:',
        rectWarningText:
          'Pipe + insulation does not fit into the opening (occupied volume exceeds opening volume). Sealant volume is set to 0.',

        labelVolumeOne: 'Volume per Penetration',
        labelTotalConsumption: '‚úÖ Total Sealant Consumption',
        labelCartridges: 'üì¶ Number of Cartridges (300 ml)',

        infoNote: '‚ÑπÔ∏è Note:',
        infoText: 'Number of cartridges is rounded up.',

        footerText: 'Fire protection solutions for buildings',
        footerContact: 'Contact',
        footerSupport: 'Technical Support',

        unitsPieces: 'pcs',

        detailsTitle: 'Calculation steps',
        showDetails: 'Show calculation steps',
        hideDetails: 'Hide calculation steps',
        calcDetail: (count, perOneMl, sealType) => {
          const mult = sealType === 'double' ? ' √ó 2 (double-sided)' : ' (single-sided)';
          return `${count} penetrations √ó ${perOneMl} ml${mult}`;
        },
      },

      cs: {
        langLabel: 'Jazyk',
        topBarText: 'Nadn√°rodn√≠ firma se srdcem | Od roku 1942',
        appTitle: 'Walraven Pacifyre¬Æ Kalkulaƒçka',
        heroTitle: 'üî• Walraven Pacifyre¬Æ Kalkulaƒçka spot≈ôeby tmelu',
        heroSubtitle: 'V√Ωpoƒçet spot≈ôeby protipo≈æ√°rn√≠ho tmelu pro prostupy ve stƒõn√°ch a podlah√°ch',

        inputsTitle: 'Vstupn√≠ parametry',
        resultsTitle: 'V√Ωsledky v√Ωpoƒçtu',

        labelSealantType: 'Typ tmelu',
        sealantALabel: 'Walraven Pacifyre¬Æ A (10 mm)',
        sealantGLabel: 'Walraven Pacifyre¬Æ G (25 mm)',
        labelDepth: 'Hloubka v√Ωplnƒõ (pevn√°: A = 10 mm, G = 25 mm)',

        labelOpeningType: 'Typ otvoru',
        labelCircular: 'Kruhov√Ω',
        labelRectangular: 'Obd√©ln√≠kov√Ω',

        titleCircular: '‚≠ï Parametry kruhov√©ho otvoru',
        labelPipeDiameter: 'Pr≈Ømƒõr potrub√≠ (mm)',
        labelInsulation: 'Tlou≈°≈•ka izolace (mm)',
        labelAnnularGap: '≈†√≠≈ôka mezery (mm)',

        pipeLimitInfoTitle: '‚ÑπÔ∏è Pozn√°mka:',
        pipeLimitInfoText: 'Pro Walraven Pacifyre¬Æ G je maxim√°ln√≠ pr≈Ømƒõr potrub√≠ 50 mm.',

        circularOpeningLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        circularOpeningLimitText: (maxMm) => `Pro Walraven Pacifyre¬Æ je maxim√°ln√≠ pr≈Ømƒõr otvoru (potrub√≠ + izolace + 2√ó mezera) ${maxMm} mm.`,

        rectWidthLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        rectWidthLimitText: 'Pro Walraven Pacifyre¬Æ G je maxim√°ln√≠ ≈°√≠≈ôka otvoru 250 mm.',
        rectHeightLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        rectHeightLimitText: 'Pro Walraven Pacifyre¬Æ G je maxim√°ln√≠ v√Ω≈°ka otvoru 250 mm.',

        titleRectangular: '‚ñ≠ Parametry obd√©ln√≠kov√©ho otvoru',
        labelOpeningWidth: '≈†√≠≈ôka otvoru (mm)',
        labelOpeningHeight: 'V√Ω≈°ka otvoru (mm)',
        labelPipeDiameterRect: 'Pr≈Ømƒõr potrub√≠ (mm)',
        labelInsulationRect: 'Tlou≈°≈•ka izolace (mm)',

        labelSealType: 'Typ ucp√°vky',
        labelSingle: 'Jednostrann√°',
        labelDouble: 'Oboustrann√°',

        labelCount: 'Poƒçet prostup≈Ø',

        calcTitleCircular: 'Meziv√Ωpoƒçty (kruhov√Ω)',
        labelD2: 'Vnƒõj≈°√≠ pr≈Ømƒõr s izolac√≠ (d2)',
        labelD3: 'Vnƒõj≈°√≠ pr≈Ømƒõr s v√Ωpln√≠ (d3)',
        labelAnnularArea: 'Plocha mezikru≈æ√≠',

        calcTitleRectangular: 'Meziv√Ωpoƒçty (obd√©ln√≠kov√Ω)',
        labelOpeningVolume: 'Objem otvoru (≈†√óV√óhloubka)',
        labelOccupiedVolume: 'Objem potrub√≠ + izolace',

        rectWarningTitle: '‚ö†Ô∏è Upozornƒõn√≠:',
        rectWarningText:
          'Potrub√≠ + izolace se nevejde do otvoru (objem potrub√≠ s izolac√≠ je vƒõt≈°√≠ ne≈æ objem otvoru). Spot≈ôeba tmelu je nastavena na 0.',

        labelVolumeOne: 'Objem jednoho prostupu',
        labelTotalConsumption: '‚úÖ Celkov√° spot≈ôeba tmelu',
        labelCartridges: 'üì¶ Poƒçet kartu≈°√≠ (300 ml)',

        infoNote: '‚ÑπÔ∏è Pozn√°mka:',
        infoText: 'Poƒçet kartu≈°√≠ je zaokrouhlen nahoru.',

        footerText: 'Protipo≈æ√°rn√≠ ≈ôe≈°en√≠ pro budovy | Fire protection solutions for buildings',
        footerContact: 'Kontakt',
        footerSupport: 'Technick√° podpora',

        unitsPieces: 'ks',

        detailsTitle: 'Postup v√Ωpoƒçtu',
        showDetails: 'Zobrazit postup v√Ωpoƒçtu',
        hideDetails: 'Skr√Ωt postup v√Ωpoƒçtu',
        calcDetail: (count, perOneMl, sealType) => {
          const mult = sealType === 'double' ? ' √ó 2 (oboustrann√°)' : ' (jednostrann√°)';
          return `${count} prostup≈Ø √ó ${perOneMl} ml${mult}`;
        },
      },

      sk: {
        langLabel: 'Jazyk',
        topBarText: 'Nadn√°rodn√° firma so srdcom | Od roku 1942',
        appTitle: 'Walraven Pacifyre¬Æ Kalkulaƒçka',
        heroTitle: 'üî• Walraven Pacifyre¬Æ Kalkulaƒçka spotreby tmelu',
        heroSubtitle: 'V√Ωpoƒçet spotreby protipo≈æiarneho tmelu pre prestupy v sten√°ch a podlah√°ch',

        inputsTitle: 'Vstupn√© parametre',
        resultsTitle: 'V√Ωsledky v√Ωpoƒçtu',

        labelSealantType: 'Typ tmelu',
        sealantALabel: 'Walraven Pacifyre¬Æ A (10 mm)',
        sealantGLabel: 'Walraven Pacifyre¬Æ G (25 mm)',
        labelDepth: 'Hƒ∫bka v√Ωplne (pevn√°: A = 10 mm, G = 25 mm)',

        labelOpeningType: 'Typ otvoru',
        labelCircular: 'Kruhov√Ω',
        labelRectangular: 'Obdƒ∫≈ænikov√Ω',

        titleCircular: '‚≠ï Parametre kruhov√©ho otvoru',
        labelPipeDiameter: 'Priemer potrubia (mm)',
        labelInsulation: 'Hr√∫bka izol√°cie (mm)',
        labelAnnularGap: '≈†√≠rka medzery (mm)',

        pipeLimitInfoTitle: '‚ÑπÔ∏è Pozn√°mka:',
        pipeLimitInfoText: 'Pre Walraven Pacifyre¬Æ G je maxim√°lny priemer potrubia 50 mm.',

        circularOpeningLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        circularOpeningLimitText: (maxMm) => `Pre Walraven Pacifyre¬Æ je maxim√°lny priemer otvoru (potrubie + izol√°cia + 2√ó medzera) ${maxMm} mm.`,

        rectWidthLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        rectWidthLimitText: 'Pre Walraven Pacifyre¬Æ G je maxim√°lna ≈°√≠rka otvoru 250 mm.',
        rectHeightLimitTitle: '‚ÑπÔ∏è Pozn√°mka:',
        rectHeightLimitText: 'Pre Walraven Pacifyre¬Æ G je maxim√°lna v√Ω≈°ka otvoru 250 mm.',

        titleRectangular: '‚ñ≠ Parametre obdƒ∫≈ænikov√©ho otvoru',
        labelOpeningWidth: '≈†√≠rka otvoru (mm)',
        labelOpeningHeight: 'V√Ω≈°ka otvoru (mm)',
        labelPipeDiameterRect: 'Priemer potrubia (mm)',
        labelInsulationRect: 'Hr√∫bka izol√°cie (mm)',

        labelSealType: 'Typ utesnenia',
        labelSingle: 'Jednostrann√©',
        labelDouble: 'Obojstrann√©',

        labelCount: 'Poƒçet prestupov',

        calcTitleCircular: 'Medziv√Ωpoƒçty (kruhov√Ω)',
        labelD2: 'Vonkaj≈°√≠ priemer s izol√°ciou (d2)',
        labelD3: 'Vonkaj≈°√≠ priemer s v√Ωpl≈àou (d3)',
        labelAnnularArea: 'Plocha medzikru≈æia',

        calcTitleRectangular: 'Medziv√Ωpoƒçty (obdƒ∫≈ænikov√Ω)',
        labelOpeningVolume: 'Objem otvoru (≈†√óV√óhƒ∫bka)',
        labelOccupiedVolume: 'Objem potrubia + izol√°cie',

        rectWarningTitle: '‚ö†Ô∏è Upozornenie:',
        rectWarningText:
          'Potrubie + izol√°cia sa nezmestia do otvoru (objem potrubia s izol√°ciou je v√§ƒç≈°√≠ ne≈æ objem otvoru). Spotreba tmelu je nastaven√° na 0.',

        labelVolumeOne: 'Objem jedn√©ho prestupu',
        labelTotalConsumption: '‚úÖ Celkov√° spotreba tmelu',
        labelCartridges: 'üì¶ Poƒçet kartu≈°√≠ (300 ml)',

        infoNote: '‚ÑπÔ∏è Pozn√°mka:',
        infoText: 'Poƒçet kartu≈°√≠ je zaokr√∫hlen√Ω nahor.',

        footerText: 'Protipo≈æiarne rie≈°enia pre budovy',
        footerContact: 'Kontakt',
        footerSupport: 'Technick√° podpora',

        unitsPieces: 'ks',

        detailsTitle: 'Postup v√Ωpoƒçtu',
        showDetails: 'Zobrazi≈• postup v√Ωpoƒçtu',
        hideDetails: 'Skry≈• postup v√Ωpoƒçtu',
        calcDetail: (count, perOneMl, sealType) => {
          const mult = sealType === 'double' ? ' √ó 2 (obojstrann√©)' : ' (jednostrann√©)';
          return `${count} prestupov √ó ${perOneMl} ml${mult}`;
        },
      },

      pl: {
        langLabel: 'Jƒôzyk',
        topBarText: 'Wielonarodowa firma z sercem | Od 1942 roku',
        appTitle: 'Walraven Pacifyre¬Æ Kalkulator',
        heroTitle: 'üî• Walraven Pacifyre¬Æ Kalkulator zu≈ºycia uszczelniacza',
        heroSubtitle: 'Obliczanie zu≈ºycia uszczelniacza przeciwpo≈ºarowego dla przej≈õƒá w ≈õcianach i pod≈Çogach',

        inputsTitle: 'Parametry wej≈õciowe',
        resultsTitle: 'Wyniki oblicze≈Ñ',

        labelSealantType: 'Typ uszczelniacza',
        sealantALabel: 'Walraven Pacifyre¬Æ A (10 mm)',
        sealantGLabel: 'Walraven Pacifyre¬Æ G (25 mm)',
        labelDepth: 'G≈Çƒôboko≈õƒá wype≈Çnienia (sta≈Ça: A = 10 mm, G = 25 mm)',

        labelOpeningType: 'Typ otworu',
        labelCircular: 'OkrƒÖg≈Çy',
        labelRectangular: 'ProstokƒÖtny',

        titleCircular: '‚≠ï Parametry otworu okrƒÖg≈Çego',
        labelPipeDiameter: '≈örednica rury (mm)',
        labelInsulation: 'Grubo≈õƒá izolacji (mm)',
        labelAnnularGap: 'Szeroko≈õƒá szczeliny (mm)',

        pipeLimitInfoTitle: '‚ÑπÔ∏è Uwaga:',
        pipeLimitInfoText: 'Dla Walraven Pacifyre¬Æ G maksymalna ≈õrednica rury wynosi 50 mm.',

        circularOpeningLimitTitle: '‚ÑπÔ∏è Uwaga:',
        circularOpeningLimitText: (maxMm) => `Dla Walraven Pacifyre¬Æ maksymalna ≈õrednica otworu (rura + izolacja + 2√ó szczelina) wynosi ${maxMm} mm.`,

        rectWidthLimitTitle: '‚ÑπÔ∏è Uwaga:',
        rectWidthLimitText: 'Dla Walraven Pacifyre¬Æ G maksymalna szeroko≈õƒá otworu wynosi 250 mm.',
        rectHeightLimitTitle: '‚ÑπÔ∏è Uwaga:',
        rectHeightLimitText: 'Dla Walraven Pacifyre¬Æ G maksymalna wysoko≈õƒá otworu wynosi 250 mm.',

        titleRectangular: '‚ñ≠ Parametry otworu prostokƒÖtnego',
        labelOpeningWidth: 'Szeroko≈õƒá otworu (mm)',
        labelOpeningHeight: 'Wysoko≈õƒá otworu (mm)',
        labelPipeDiameterRect: '≈örednica rury (mm)',
        labelInsulationRect: 'Grubo≈õƒá izolacji (mm)',

        labelSealType: 'Typ uszczelnienia',
        labelSingle: 'Jednostronne',
        labelDouble: 'Dwustronne',

        labelCount: 'Liczba przej≈õƒá',

        calcTitleCircular: 'Obliczenia po≈õrednie (okrƒÖg≈Çy)',
        labelD2: '≈örednica zewnƒôtrzna z izolacjƒÖ (d2)',
        labelD3: '≈örednica zewnƒôtrzna z wype≈Çnieniem (d3)',
        labelAnnularArea: 'Pole pier≈õcienia',

        calcTitleRectangular: 'Obliczenia po≈õrednie (prostokƒÖtny)',
        labelOpeningVolume: 'Objƒôto≈õƒá otworu (S√óW√óg≈Çƒôb.)',
        labelOccupiedVolume: 'Objƒôto≈õƒá rury + izolacji',

        rectWarningTitle: '‚ö†Ô∏è Ostrze≈ºenie:',
        rectWarningText:
          'Rura + izolacja nie mieszczƒÖ siƒô w otworze (objƒôto≈õƒá rury z izolacjƒÖ jest wiƒôksza ni≈º objƒôto≈õƒá otworu). Zu≈ºycie uszczelniacza ustawiono na 0.',

        labelVolumeOne: 'Objƒôto≈õƒá na jedno przej≈õcie',
        labelTotalConsumption: '‚úÖ Ca≈Çkowite zu≈ºycie uszczelniacza',
        labelCartridges: 'üì¶ Liczba kartuszy (300 ml)',

        infoNote: '‚ÑπÔ∏è Uwaga:',
        infoText: 'Liczba kartuszy jest zaokrƒÖglana w g√≥rƒô.',

        footerText: 'RozwiƒÖzania ochrony przeciwpo≈ºarowej dla budynk√≥w',
        footerContact: 'Kontakt',
        footerSupport: 'Wsparcie techniczne',

        unitsPieces: 'szt.',

        detailsTitle: 'Kroki oblicze≈Ñ',
        showDetails: 'Poka≈º kroki oblicze≈Ñ',
        hideDetails: 'Ukryj kroki oblicze≈Ñ',
        calcDetail: (count, perOneMl, sealType) => {
          const mult = sealType === 'double' ? ' √ó 2 (dwustronne)' : ' (jednostronne)';
          return `${count} przej≈õƒá √ó ${perOneMl} ml${mult}`;
        },
      },

      nl: {
        langLabel: 'Taal',
        topBarText: 'Multinationaal met een hart | Sinds 1942',
        appTitle: 'Walraven Pacifyre¬Æ Calculator',
        heroTitle: 'üî• Walraven Pacifyre¬Æ Kitverbruik Calculator',
        heroSubtitle: 'Berekening brandwerende kitverbruik voor doorvoeren in wanden en vloeren',

        inputsTitle: 'Invoerparameters',
        resultsTitle: 'Berekeningsresultaten',

        labelSealantType: 'Kittype',
        sealantALabel: 'Walraven Pacifyre¬Æ A (10 mm)',
        sealantGLabel: 'Walraven Pacifyre¬Æ G (25 mm)',
        labelDepth: 'Vuldpite (vast: A = 10 mm, G = 25 mm)',

        labelOpeningType: 'Type opening',
        labelCircular: 'Rond',
        labelRectangular: 'Rechthoekig',

        titleCircular: '‚≠ï Parameters ronde opening',
        labelPipeDiameter: 'Buisdiameter (mm)',
        labelInsulation: 'Isolatiedikte (mm)',
        labelAnnularGap: 'Ringspeling breedte (mm)',

        pipeLimitInfoTitle: '‚ÑπÔ∏è Opmerking:',
        pipeLimitInfoText: 'Voor Walraven Pacifyre¬Æ G is de maximale buisdiameter 50 mm.',

        circularOpeningLimitTitle: '‚ÑπÔ∏è Opmerking:',
        circularOpeningLimitText: (maxMm) => `Voor Walraven Pacifyre¬Æ is de maximale openingsdiameter (buis + isolatie + 2√ó speling) ${maxMm} mm.`,

        rectWidthLimitTitle: '‚ÑπÔ∏è Opmerking:',
        rectWidthLimitText: 'Voor Walraven Pacifyre¬Æ G is de maximale breedte van de opening 250 mm.',
        rectHeightLimitTitle: '‚ÑπÔ∏è Opmerking:',
        rectHeightLimitText: 'Voor Walraven Pacifyre¬Æ G is de maximale hoogte van de opening 250 mm.',

        titleRectangular: '‚ñ≠ Parameters rechthoekige opening',
        labelOpeningWidth: 'Breedte opening (mm)',
        labelOpeningHeight: 'Hoogte opening (mm)',
        labelPipeDiameterRect: 'Buisdiameter (mm)',
        labelInsulationRect: 'Isolatiedikte (mm)',

        labelSealType: 'Type afdichting',
        labelSingle: 'Enkelzijdig',
        labelDouble: 'Dubbelzijdig',

        labelCount: 'Aantal doorvoeren',

        calcTitleCircular: 'Tussenberekeningen (rond)',
        labelD2: 'Buitendiameter met isolatie (d2)',
        labelD3: 'Buitendiameter met vulling (d3)',
        labelAnnularArea: 'Ringoppervlak',

        calcTitleRectangular: 'Tussenberekeningen (rechthoekig)',
        labelOpeningVolume: 'Openingsvolume (B√óH√ódiepte)',
        labelOccupiedVolume: 'Volume buis + isolatie',

        rectWarningTitle: '‚ö†Ô∏è Waarschuwing:',
        rectWarningText:
          'Buis + isolatie passen niet in de opening (volume buis met isolatie is groter dan openingsvolume). Kitvolume is ingesteld op 0.',

        labelVolumeOne: 'Volume per doorvoer',
        labelTotalConsumption: '‚úÖ Totaal kitverbruik',
        labelCartridges: 'üì¶ Aantal kokers (300 ml)',

        infoNote: '‚ÑπÔ∏è Opmerking:',
        infoText: 'Aantal kokers wordt naar boven afgerond.',

        footerText: 'Brandwerende oplossingen voor gebouwen',
        footerContact: 'Contact',
        footerSupport: 'Technische ondersteuning',

        unitsPieces: 'st.',

        detailsTitle: 'Berekeningsstappen',
        showDetails: 'Toon berekeningsstappen',
        hideDetails: 'Verberg berekeningsstappen',
        calcDetail: (count, perOneMl, sealType) => {
          const mult = sealType === 'double' ? ' √ó 2 (dubbelzijdig)' : ' (enkelzijdig)';
          return `${count} doorvoeren √ó ${perOneMl} ml${mult}`;
        },
      },
    };

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // HELPERS
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    let currentLang = 'en';

    function getEl(id) {
      return document.getElementById(id);
    }

    function setText(id, value) {
      const el = getEl(id);
      if (!el) return false;
      el.textContent = value;
      return true;
    }

    // setHtml is only used for numeric output ‚Äî not user-supplied strings ‚Äî so XSS risk is negligible.
    function setHtml(id, value) {
      const el = getEl(id);
      if (!el) return false;
      el.innerHTML = value;
      return true;
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // LANGUAGE
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function setLanguage(lang) {
      currentLang = translations[lang] ? lang : 'en';
      const t = translations[currentLang];

      document.documentElement.lang = currentLang;

      setText('langLabel', t.langLabel);
      setText('topBarText', t.topBarText);
      setText('appTitle', t.appTitle);
      setText('heroTitle', t.heroTitle);
      setText('heroSubtitle', t.heroSubtitle);

      setText('inputsTitle', t.inputsTitle);
      setText('resultsTitle', t.resultsTitle);

      setText('labelSealantType', t.labelSealantType);
      setText('sealantALabel', t.sealantALabel);
      setText('sealantGLabel', t.sealantGLabel);
      setText('labelDepthText', t.labelDepth);

      setText('labelOpeningType', t.labelOpeningType);
      setText('labelCircular', t.labelCircular);
      setText('labelRectangular', t.labelRectangular);

      setText('titleCircular', t.titleCircular);
      setText('labelPipeDiameter', t.labelPipeDiameter);
      setText('labelInsulation', t.labelInsulation);
      setText('labelAnnularGap', t.labelAnnularGap);
      setText('pipeLimitInfoTitle', t.pipeLimitInfoTitle);
      setText('pipeLimitInfoText', t.pipeLimitInfoText);
      setText('pipeLimitInfoTitleRect', t.pipeLimitInfoTitle);
      setText('pipeLimitInfoTextRect', t.pipeLimitInfoText);

      setText('circularOpeningLimitTitle', t.circularOpeningLimitTitle);
      // circularOpeningLimitText is set dynamically in enforcePipeLimit (value depends on sealant type)

      setText('rectWidthLimitTitle',  t.rectWidthLimitTitle);
      setText('rectWidthLimitText',   t.rectWidthLimitText);
      setText('rectHeightLimitTitle', t.rectHeightLimitTitle);
      setText('rectHeightLimitText',  t.rectHeightLimitText);

      setText('titleRectangular', t.titleRectangular);
      setText('labelOpeningWidth', t.labelOpeningWidth);
      setText('labelOpeningHeight', t.labelOpeningHeight);
      setText('labelPipeDiameterRect', t.labelPipeDiameterRect);
      setText('labelInsulationRect', t.labelInsulationRect);

      setText('labelSealType', t.labelSealType);
      setText('labelDouble', t.labelDouble);
      setText('labelSingle', t.labelSingle);
      setText('labelCount', t.labelCount);

      setText('calcTitleCircular', t.calcTitleCircular);
      setText('labelD2', t.labelD2);
      setText('labelD3', t.labelD3);
      setText('labelAnnularArea', t.labelAnnularArea);

      setText('calcTitleRectangular', t.calcTitleRectangular);
      setText('labelOpeningVolume', t.labelOpeningVolume);
      setText('labelOccupiedVolume', t.labelOccupiedVolume);

      setText('rectWarningTitle', t.rectWarningTitle);
      setText('rectWarningText', t.rectWarningText);

      setText('labelVolumeOne', t.labelVolumeOne);
      setText('labelTotalConsumption', t.labelTotalConsumption);
      setText('labelCartridges', t.labelCartridges);

      setText('infoNote', t.infoNote);
      setText('infoText', t.infoText);

      setText('footerText', t.footerText);
      setText('footerContact', t.footerContact);
      setText('footerSupport', t.footerSupport);

      setText('detailsTitle', t.detailsTitle);
      const btn = getEl('toggleDetails');
      const btnText = getEl('toggleDetailsText');
      if (btn && btnText) {
        const expanded = btn.getAttribute('aria-expanded') === 'true';
        btnText.textContent = expanded ? t.hideDetails : t.showDetails;
      }

      const sel = getEl('langSelect');
      if (sel && sel.value !== currentLang) sel.value = currentLang;

      calculate();
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // ENFORCE LIMITS FOR PACIFYRE G
    //   ‚Ä¢ Pipe diameter (circular + rect):  max 50 mm
    //   ‚Ä¢ Rect opening width / height:      max 250 mm  ‚Üí warning only
    //   ‚Ä¢ Circular opening total diameter:  max 250 mm  ‚Üí warning only
    //     (total = pipe + 2√óinsulation + 2√ógap; shown under "Annular Gap")
    // All warnings are informational only ‚Äî values are NOT clamped for
    // width/height/total-opening so the user can still see the result.
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function enforcePipeLimit() {
      const sealantType = document.querySelector('input[name="sealantType"]:checked')?.value || 'A';
      const isG = sealantType === 'G';

      // ‚îÄ‚îÄ 1. Pipe diameter: hard clamp to 50 mm for Pacifyre G ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const maxPipe = isG ? 50 : null;
      [getEl('pipeDiameter'), getEl('pipeDiameterRect')].forEach((input) => {
        if (!input) return;
        if (maxPipe !== null) {
          input.max = String(maxPipe);
          if (parseFloat(input.value) > maxPipe) input.value = String(maxPipe);
        } else {
          input.removeAttribute('max');
        }
      });
      const showPipeInfo = getEl('pipeLimitInfo');
      const showPipeInfoRect = getEl('pipeLimitInfoRect');
      if (showPipeInfo)     showPipeInfo.classList.toggle('hidden', !isG);
      if (showPipeInfoRect) showPipeInfoRect.classList.toggle('hidden', !isG);

      // ‚îÄ‚îÄ 2. Rectangular opening: warn when width or height > 250 mm ‚îÄ
      const maxRectDim = 250;
      const wVal = parseFloat(getEl('openingWidth')?.value) || 0;
      const hVal = parseFloat(getEl('openingHeight')?.value) || 0;
      const rectWidthWarn  = getEl('rectWidthLimitInfo');
      const rectHeightWarn = getEl('rectHeightLimitInfo');
      if (rectWidthWarn)  rectWidthWarn.classList.toggle('hidden',  !isG || wVal <= maxRectDim);
      if (rectHeightWarn) rectHeightWarn.classList.toggle('hidden', !isG || hVal <= maxRectDim);

      // ‚îÄ‚îÄ 3. Circular opening: warn when total opening √ò exceeds limit ‚îÄ‚îÄ‚îÄ‚îÄ
      //    total √ò  = pipeDiameter + 2√óinsulation + 2√óannularGap  (= d3)
      //    Pacifyre A ‚Üí max 300 mm | Pacifyre G ‚Üí max 250 mm
      const maxCircDiam = isG ? 250 : 300;
      const pipeD = parseFloat(getEl('pipeDiameter')?.value) || 0;
      const ins   = parseFloat(getEl('insulationThickness')?.value) || 0;
      const gap   = parseFloat(getEl('annularGap')?.value) || 0;
      const totalCircDiam = pipeD + 2 * ins + 2 * gap;
      const circOpeningWarn = getEl('circularOpeningLimitInfo');
      if (circOpeningWarn) {
        circOpeningWarn.classList.toggle('hidden', totalCircDiam <= maxCircDiam);
        // Update the text dynamically so it always shows the correct limit for the selected sealant
        const t = translations[currentLang] || translations.en;
        setText('circularOpeningLimitText', t.circularOpeningLimitText(maxCircDiam));
      }
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // DEPTH
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function setDepth() {
      const sealantType = document.querySelector('input[name="sealantType"]:checked')?.value || 'A';
      const depth = sealantType === 'A' ? 10 : 25;
      const depthEl = getEl('depth');
      if (depthEl) depthEl.value = String(depth);

      enforcePipeLimit();
      calculate();
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // OPENING TYPE TOGGLE
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function toggleOpeningType() {
      const openingType = document.querySelector('input[name="openingType"]:checked')?.value || 'circular';

      const circularSection = getEl('circularSection');
      const rectangularSection = getEl('rectangularSection');
      const calcCircular = getEl('calcCircular');
      const calcRectangular = getEl('calcRectangular');
      const warn = getEl('rectWarning');

      if (openingType === 'circular') {
        if (circularSection) { circularSection.style.display = 'block'; circularSection.classList.add('active'); }
        if (rectangularSection) { rectangularSection.style.display = 'none'; rectangularSection.classList.remove('active'); }
        if (calcCircular) calcCircular.style.display = 'block';
        if (calcRectangular) calcRectangular.style.display = 'none';
        if (warn) warn.classList.add('hidden');
      } else {
        if (circularSection) { circularSection.style.display = 'none'; circularSection.classList.remove('active'); }
        if (rectangularSection) { rectangularSection.style.display = 'block'; rectangularSection.classList.add('active'); }
        if (calcCircular) calcCircular.style.display = 'none';
        if (calcRectangular) calcRectangular.style.display = 'block';
      }

      calculate();
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // TOGGLE DETAILS
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function toggleDetails() {
      const panel = getEl('detailsPanel');
      const btn = getEl('toggleDetails');
      const txt = getEl('toggleDetailsText');
      if (!panel || !btn || !txt) return;

      const t = translations[currentLang] || translations.en;
      const isHidden = panel.classList.contains('hidden');

      if (isHidden) {
        panel.classList.remove('hidden');
        panel.setAttribute('aria-hidden', 'false');
        btn.setAttribute('aria-expanded', 'true');
        txt.textContent = t.hideDetails;
      } else {
        panel.classList.add('hidden');
        panel.setAttribute('aria-hidden', 'true');
        btn.setAttribute('aria-expanded', 'false');
        txt.textContent = t.showDetails;
      }
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // PURE CALCULATION HELPERS  (FIX #4: separated from DOM writes)
    // Calculation functions return plain objects; the caller (calculate)
    // is responsible for updating the DOM. This also fixes the self-test
    // issue where calculateCircular / calculateRectangular silently
    // modified the visible UI during testing.
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function computeCircular(depth) {
      const pipeDiameter = Math.max(0, parseFloat(getEl('pipeDiameter')?.value) || 0);
      const insulation   = Math.max(0, parseFloat(getEl('insulationThickness')?.value) || 0);
      const gap          = Math.max(0, parseFloat(getEl('annularGap')?.value) || 0);

      const d2 = pipeDiameter + 2 * insulation;
      const d3 = d2 + 2 * gap;
      const r2 = d2 / 2;
      const r3 = d3 / 2;
      const annularArea = Math.PI * (r3 * r3 - r2 * r2);
      const volumeOneMl = Math.max(0, (annularArea * depth) / 1000);

      return { d2, d3, annularArea, volumeOneMl };
    }

    function computeRectangular(depth) {
      const w    = Math.max(0, parseFloat(getEl('openingWidth')?.value) || 0);
      const h    = Math.max(0, parseFloat(getEl('openingHeight')?.value) || 0);
      const pipeD = Math.max(0, parseFloat(getEl('pipeDiameterRect')?.value) || 0);
      const ins  = Math.max(0, parseFloat(getEl('insulationThicknessRect')?.value) || 0);

      const openingVolMm3  = w * h * depth;
      const rOuter         = pipeD / 2 + ins;
      const occupiedVolMm3 = Math.PI * rOuter * rOuter * depth;
      const overfilled     = occupiedVolMm3 > openingVolMm3;
      const sealantVolMm3  = Math.max(0, openingVolMm3 - occupiedVolMm3);

      return {
        openingVolMl:  openingVolMm3  / 1000,
        occupiedVolMl: occupiedVolMm3 / 1000,
        volumeOneMl:   sealantVolMm3  / 1000,
        overfilled,
      };
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // MAIN CALCULATE (reads inputs, calls pure helpers, updates DOM)
    // FIX #5: guard against depth = 0 with a visible note
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function calculate() {
      const openingType = document.querySelector('input[name="openingType"]:checked')?.value || 'circular';
      const depth       = Math.max(0, parseFloat(getEl('depth')?.value) || 0);
      const sealType    = document.querySelector('input[name="sealType"]:checked')?.value || 'double';
      const count       = Math.max(0, parseFloat(getEl('penetrationCount')?.value) || 0);
      const multiplier  = sealType === 'double' ? 2 : 1;

      let volumeOneMl = 0;

      if (openingType === 'circular') {
        const res = computeCircular(depth);
        // Update intermediate DOM results
        setHtml('d2',          `${res.d2.toFixed(1)}<span class="result-unit">mm</span>`);
        setHtml('d3',          `${res.d3.toFixed(1)}<span class="result-unit">mm</span>`);
        setHtml('annularArea', `${res.annularArea.toFixed(1)}<span class="result-unit">mm¬≤</span>`);
        volumeOneMl = res.volumeOneMl;
      } else {
        const res = computeRectangular(depth);
        setHtml('openingVolume',  `${res.openingVolMl.toFixed(1)}<span class="result-unit">ml</span>`);
        setHtml('occupiedVolume', `${res.occupiedVolMl.toFixed(1)}<span class="result-unit">ml</span>`);
        const warn = getEl('rectWarning');
        if (warn) warn.classList.toggle('hidden', !res.overfilled);
        volumeOneMl = res.volumeOneMl;
      }

      const totalMl   = Math.max(0, volumeOneMl * count * multiplier);
      const cartridges = totalMl > 0 ? Math.ceil(totalMl / 300) : 0;

      setHtml('volumeOne',       `${volumeOneMl.toFixed(1)}<span class="result-unit">ml</span>`);
      setHtml('totalConsumption',`${totalMl.toFixed(1)}<span class="result-unit">ml</span>`);

      const t = translations[currentLang] || translations.en;
      setHtml('cartridges', `${cartridges}<span class="result-unit">${t.unitsPieces}</span>`);

      const detail = t.calcDetail(count, volumeOneMl.toFixed(1), sealType);
      setText('calcDetail', ` ${detail}`);
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // SELF-TESTS  (FIX #6: isolated ‚Äî save and restore all state;
    //              use pure compute* helpers to avoid DOM side-effects)
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function runSelfTests() {
      console.group('Walraven Pacifyre¬Æ calculator self-tests');

      // Helper: temporarily set input values and restore afterwards
      function withInputs(overrides, fn) {
        const saved = {};
        Object.keys(overrides).forEach((id) => {
          const el = getEl(id);
          if (el) { saved[id] = el.value; el.value = overrides[id]; }
        });
        const result = fn();
        Object.keys(saved).forEach((id) => { getEl(id).value = saved[id]; });
        return result;
      }

      // Test 1: circular volume should be non-negative
      const circ = withInputs(
        { pipeDiameter: '100', insulationThickness: '30', annularGap: '20', depth: '10' },
        () => computeCircular(10)
      );
      console.assert(circ.volumeOneMl >= 0, 'T1 PASS: Circular volume >= 0');

      // Test 2: rectangular overfill ‚Üí volume = 0
      const rect = withInputs(
        { openingWidth: '50', openingHeight: '50', pipeDiameterRect: '150', insulationThicknessRect: '20' },
        () => computeRectangular(10)
      );
      console.assert(rect.overfilled  === true, 'T2 PASS: Rectangular should be overfilled');
      console.assert(rect.volumeOneMl === 0,    'T3 PASS: Rectangular volume is 0 when overfilled');

      // Test 3: Pacifyre G clamp ‚Äî simulate a value > 50 and verify clamping logic
      const pipeEl = getEl('pipeDiameter');
      if (pipeEl) {
        const savedVal = pipeEl.value;
        const savedMax = pipeEl.getAttribute('max');
        // Simulate G-type selection by directly calling with high value
        pipeEl.value = '120';
        pipeEl.max = '50';
        if (parseFloat(pipeEl.value) > 50) pipeEl.value = '50';
        console.assert(parseFloat(pipeEl.value) <= 50, 'T4 PASS: Pacifyre G clamps pipe diameter to ‚â§ 50 mm');
        // Restore
        pipeEl.value = savedVal;
        if (savedMax) pipeEl.setAttribute('max', savedMax);
        else pipeEl.removeAttribute('max');
      }

      console.groupEnd();
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // BROWSER LANGUAGE DETECTION
    // navigator.languages returns ordered list e.g. ['cs-CZ', 'cs', 'en-US', 'en']
    // We check the base language code (first two chars) against available keys.
    // If no match is found, fall back to 'en'.
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function detectBrowserLanguage() {
      const supported = Object.keys(translations); // ['en','cs','sk','pl','nl']
      const preferred = navigator.languages?.length ? navigator.languages : [navigator.language || 'en'];
      for (const lang of preferred) {
        const code = lang.slice(0, 2).toLowerCase();
        if (supported.includes(code)) return code;
      }
      return 'en';
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // INIT
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.addEventListener('DOMContentLoaded', () => {
      const initialLang = detectBrowserLanguage();
      const langSelect = getEl('langSelect');
      if (langSelect) {
        langSelect.value = initialLang;
        langSelect.addEventListener('change', (e) => setLanguage(e.target.value));
      }

      document.querySelectorAll('input[name="sealantType"]').forEach((r) =>
        r.addEventListener('change', setDepth)
      );

      document.querySelectorAll('input[name="openingType"]').forEach((r) =>
        r.addEventListener('change', () => {
          toggleOpeningType();
          enforcePipeLimit();
        })
      );

      document.querySelectorAll('input[name="sealType"]').forEach((r) =>
        r.addEventListener('change', calculate)
      );

      document.querySelectorAll('input[type="number"]').forEach((i) =>
        i.addEventListener('input', () => {
          enforcePipeLimit();
          calculate();
        })
      );

      const toggleBtn = getEl('toggleDetails');
      if (toggleBtn) toggleBtn.addEventListener('click', toggleDetails);

      // Initialize UI with detected language
      setLanguage(initialLang);
      setDepth();
      toggleOpeningType();
      enforcePipeLimit();
      calculate();

      // Run isolated self-tests (output to console only, no UI impact)
      runSelfTests();
    });
  </script>
</body>
</html>
